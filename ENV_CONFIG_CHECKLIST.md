# Environment Variables Checklist for Stripe Integration

## Next.js Application (.env.local)

- [ ] `STRIPE_SECRET_KEY` - Your Stripe API Secret Key 
- [ ] `STRIPE_PUBLISHABLE_KEY` - Your Stripe Publishable Key
- [ ] `STRIPE_WEBHOOK_SECRET` - Secret for webhook signature verification
- [ ] `FASTAPI_URL` - URL for the FastAPI backend (e.g., http://localhost:8000)
- [ ] `INTERNAL_SECRET` - Shared secret for secure communication between Next.js and FastAPI

## FastAPI Application (.env)

- [ ] `STRIPE_API_KEY` - Your Stripe API Secret Key (same value as STRIPE_SECRET_KEY in Next.js)
- [ ] `STRIPE_BASIC_PRICE_ID` - The price ID for the basic subscription tier
- [ ] `STRIPE_PREMIUM_PRICE_ID` - The price ID for the premium subscription tier
- [ ] `STRIPE_ENTERPRISE_PRICE_ID` - The price ID for the enterprise subscription tier (if used)
- [ ] `INTERNAL_SECRET` - Must be the same value as in Next.js for secure communication
- [ ] `DASHBOARD_URL` - URL for the Next.js frontend (e.g., http://localhost:3000)

## Important Notes

1. The `INTERNAL_SECRET` must be identical in both applications.
2. Make sure the `FASTAPI_URL` in Next.js points to the correct FastAPI endpoint.
3. The webhook secrets should be generated by Stripe when you set up your webhook endpoint.
4. For local testing, you can use [Stripe CLI](https://stripe.com/docs/stripe-cli) to forward webhook events to your local environment.

## Testing Guide

1. Start both the FastAPI and Next.js servers
2. Use the Stripe CLI to forward webhooks: 
   ```
   stripe listen --forward-to http://localhost:3000/api/webhooks/stripe
   ```
3. Create a checkout session and complete payment to trigger webhook events
4. Check the logs in both Next.js and FastAPI to ensure events are being properly forwarded and processed 